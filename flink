#!/usr/bin/env zsh

action=$1
param1=$2
param2=$3

FLINK_DIR=/Users/xin.hao/flink-1.12.0/bin

start() {
  cd $FLINK_DIR
  ./start-cluster.sh
}

stop() {
  cd $FLINK_DIR
  ./stop-cluster.sh
}

restart() {
  cd $FLINK_DIR
  ./stop-cluster.sh
  ./start-cluster.sh
}

usage() {
  echo Usage
  echo '  - restart'
  echo '  - start'
  echo '  - stop'
  echo '  - run'
  echo '  - run_batch'
}

run() {
  echo TODO
}

run_batch() {
  echo TODO
}

case $action in
  restart)
    restart
  ;;
  start)
    start
  ;;
  stop)
    stop
  ;;
  run)
    run
  ;;
  run_batch)
    run_batch
  ;;
  *)
    usage
  ;;
esac
